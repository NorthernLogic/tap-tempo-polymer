<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="bpm-meter">
  <template>
    <style>
      :host {
        display: block;
        background-color: var(--primary-color);
        position: relative;
      }

      .meter {
        height: 64px;
      }

      .meter #needle {
        width: 5px;
        height: 64px;
        background: rgba(0, 0, 0, .87);
        border-bottom-left-radius: 5px;
        border-bottom-right-radius: 5px;
        border-top-left-radius: 100%;
        border-top-right-radius: 100%;
        display: inline-block;
        left: 50%;
        position: absolute;
        bottom: 0;
        -webkit-animation: metronome 5s infinite;
        transform:rotate(0deg);
        transform-origin:bottom;
      }

      @-webkit-keyframes metronome {
        0%   { transform:rotate(-90deg); }
        50%  { transform:rotate( 90deg); }
        100% { transform:rotate(-90deg); }
      }
    </style>

    <div class="meter">
      <span id="needle"></span>
    </div>

  </template>
  <script>
    Polymer({
      is: 'bpm-meter',

      properties: {
        bpm: {
          type: Number,
          observer: '_bpmChanged'
        }
      },

      _bpmChanged: function(newValue, oldValue) {
        this.$.needle.style.animationDuration = (60/newValue*2) + 's';
        console.log('bpm changed', newValue);
      }

    });
  </script>
</dom-module>
